#!/bin/bash
function _start
{
    echo  "starting application...."
    # Run webpack watcher
    cd server/ && npm run watch &
    # Run python server
    python ./run.py &
}

function _unset_envs
{
    unset $(cat .env | egrep -o '(^[^#])(\w+?)' | xargs)
}

function _export_envs
{
    envs = $(cat $2)
    if [ ! env ]; then
        echo "env file is empty, please provide valid path to the .env file"
    else
        echo envs
    fi
}

function _stop
{
    echo  "Stop application...."
    pkill -f "npm|node|python"
}

: '
    NAME

      --  app [start|stop]

    DESCRIPTION
        starts/stops the `webpack` background watch and the python web server.
'
case "$1" in
    start)
        _start
        ;;
    stop)
        _stop
        ;;
    unset_envs)
        _unset_envs
        ;;
    export_envs)
        _exports_envs
        ;;
    *)
        echo "Usage: app  {start|stop|status}"
esac
